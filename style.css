/* ═══════════════════════════════════════════════════════════════
   Cote-OS v7.6  ·  Stylesheet
   Themes: classic | light | dark
   Changes vs v7.5:
   • .rnk-num rule removed — ranking numeric cells revert to the
     standard table font (var(--fm) at .72rem, no extra class needed).
     PP/PRP/stat/overall columns all use the same clean base font.
   • .ov-score-val: font-size restored to v7.4 value (1.6rem)
   • .radar-wrap: padding restored to v7.4 value (6px)
   • Classic --t3 retained at #2e4e6a (v7.3 brightness, kept)
   • All v7.5 structural fixes (gear tray, BGM hitbox, z-indices)
     are preserved unchanged
   ═══════════════════════════════════════════════════════════════ */

/* ── THEME: Classic ──────────────────────────────────────────── */
:root,
[data-theme="classic"] {
  --s0: #06090d;
  --s1: #0a1017;
  --s2: #0f1820;
  --s3: #162030;
  --s4: #1c2c3e;
  --s5: #22344a;
  --bd:  #1b2c40;
  --bd2: #264560;
  --t0: #ccdde9;
  --t1: #7498b2;
  --t2: #3c5e7c;
  --t3: #2e4e6a; /* v7.3: +1 shade lighter for student ID visibility */
  --ac:  #00c8ff;
  --acd: #004f6b;
  --acg: rgba(0,200,255,.10);
  --gn:  #00ff88;
  --gnd: #003320;
  --rd:  #ff3355;
  --rdd: #330018;
  --yw:  #ffd700;
  --ywd: #332900;
  --or:  #ff8800;
  --io:  #a78bfa;
  --iod: #2c1868;
  --iog: rgba(167,139,250,.10);
  --rA:#00ff88; --rB:#00c8ff; --rC:#ffd700; --rD:#ff8800; --rE:#ff3355;
  --overlay:  rgba(0,0,0,.84);
  --modal-bg: #0a1017;
  --modal-bd: #264560;
}

/* ── THEME: Light ─────────────────────────────────────────────── */
[data-theme="light"] {
  --s0: #f0f4f8;
  --s1: #ffffff;
  --s2: #e8edf2;
  --s3: #d8e0e8;
  --s4: #c8d4de;
  --s5: #b8c8d8;
  --bd:  #c0cdd8;
  --bd2: #a0b8cc;
  --t0: #0d1a26;
  --t1: #2a4560;
  --t2: #4a6880;
  --t3: #7090a8;
  --ac:  #0080b8;
  --acd: #c8e8f8;
  --acg: rgba(0,128,184,.10);
  --gn:  #007840;
  --gnd: #d0f0e0;
  --rd:  #c0003a;
  --rdd: #f8d0da;
  --yw:  #8a6000;
  --ywd: #fff0c0;
  --or:  #b85000;
  --io:  #6040c0;
  --iod: #e8e0f8;
  --iog: rgba(96,64,192,.08);
  --rA:#007840; --rB:#0080b8; --rC:#8a6000; --rD:#b85000; --rE:#c0003a;
  --overlay:  rgba(0,0,0,.55);
  --modal-bg: #ffffff;
  --modal-bd: #a0b8cc;
}

/* ── THEME: Dark ──────────────────────────────────────────────── */
[data-theme="dark"] {
  --s0: #010204;
  --s1: #050810;
  --s2: #080c18;
  --s3: #0c1220;
  --s4: #101828;
  --s5: #141e30;
  --bd:  #101c2c;
  --bd2: #182840;
  --t0: #b0c8d8;
  --t1: #5070a0;
  --t2: #283c58;
  --t3: #141e2c;
  --ac:  #2090c0;
  --acd: #082030;
  --acg: rgba(32,144,192,.10);
  --gn:  #10d068;
  --gnd: #001810;
  --rd:  #e02040;
  --rdd: #200008;
  --yw:  #c0a000;
  --ywd: #201400;
  --or:  #c06000;
  --io:  #7050d0;
  --iod: #180d38;
  --iog: rgba(112,80,208,.10);
  --rA:#10d068; --rB:#2090c0; --rC:#c0a000; --rD:#c06000; --rE:#e02040;
  --overlay:  rgba(0,0,0,.90);
  --modal-bg: #050810;
  --modal-bd: #182840;
}

/* ── Fixed tokens ─────────────────────────────────────────────── */
:root {
  --fm: 'Share Tech Mono','Courier New',monospace;
  --fd: 'Orbitron',monospace;
  --fj: 'Noto Sans JP',sans-serif;
  --tbh: 48px;
  --tr:  .13s ease;
  --gear-tr: .22s cubic-bezier(.4,0,.2,1);
}

/* ── Reset ────────────────────────────────────────────────────── */
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html{font-size:13px;-webkit-text-size-adjust:100%}
body{
  background:var(--s0);color:var(--t0);
  font-family:var(--fm);min-height:100vh;overflow-x:hidden;
  scrollbar-width:thin;scrollbar-color:var(--bd2) var(--s1);
  transition:background .2s,color .2s;
}
button{cursor:pointer;font-family:inherit;line-height:1}
input,select,textarea{font-family:var(--fm)}
::-webkit-scrollbar{width:5px;height:5px}
::-webkit-scrollbar-track{background:var(--s1)}
::-webkit-scrollbar-thumb{background:var(--bd2);border-radius:3px}
::-webkit-scrollbar-thumb:hover{background:var(--acd)}

/* ═══════════════════════════════════════════════════════════════
   TASKBAR
═══════════════════════════════════════════════════════════════ */
#taskbar{
  position:sticky;top:0;z-index:400;
  display:flex;align-items:center;gap:6px;
  height:var(--tbh);padding:0 10px;
  background:var(--s1);border-bottom:1px solid var(--bd2);
  box-shadow:0 2px 18px rgba(0,0,0,.4);
  overflow:visible;  /* v7.4: allow bgm-column slider to extend below taskbar */
}
#tb-left{
  flex:1;min-width:0;
  display:flex;align-items:center;gap:8px;overflow:hidden;
}
#logo{
  font-family:var(--fd);font-size:.95rem;font-weight:900;
  letter-spacing:.18em;white-space:nowrap;color:var(--t0);flex-shrink:0;
}
#logo .ac{color:var(--ac)}
#ver{
  font-size:.57rem;color:var(--t2);border:1px solid var(--bd);
  padding:1px 4px;letter-spacing:.06em;flex-shrink:0;white-space:nowrap;
}
#breadcrumb{
  font-size:.72rem;color:var(--t1);white-space:nowrap;
  overflow:hidden;text-overflow:ellipsis;min-width:0;
}
#breadcrumb a{color:var(--ac);cursor:pointer}
#breadcrumb a:hover{text-decoration:underline}
.bc-sep{color:var(--t3);margin:0 4px}

#tb-center{
  flex:0 0 auto;
  display:flex;align-items:center;gap:8px;flex-shrink:0;
}
#date-block{
  display:flex;flex-direction:column;align-items:center;gap:1px;min-width:132px;
}
#date-display{
  font-family:var(--fd);font-size:.78rem;color:var(--ac);
  letter-spacing:.1em;text-align:center;white-space:nowrap;
}
/* v7.1: slot chip — Japanese only, no "· Slot N" suffix */
#slot-chip{font-size:.57rem;color:var(--t2);letter-spacing:.06em}

#tb-right{
  flex:1;min-width:0;
  display:flex;align-items:center;justify-content:flex-end;gap:6px;
}
.tb-btn{
  background:var(--s3);color:var(--t0);border:1px solid var(--bd2);
  padding:4px 9px;font-family:var(--fm);font-size:.73rem;
  letter-spacing:.04em;white-space:nowrap;transition:all var(--tr);
}
.tb-btn:hover{background:var(--s5);border-color:var(--ac);color:var(--ac)}
.tb-btn:active{transform:scale(.97)}

/* ── Gear Accordion ──────────────────────────────────────────── */
#gear-wrap{
  display:flex;align-items:center;
  position:relative;overflow:visible;
}
#gear-btn{
  width:34px;height:34px;
  background:var(--s3);border:1px solid var(--bd2);
  color:var(--t1);font-size:1.1rem;
  display:flex;align-items:center;justify-content:center;
  transition:all var(--tr);flex-shrink:0;z-index:2;
}
#gear-btn:hover{border-color:var(--ac);color:var(--ac);background:var(--s4)}
#gear-btn.open{border-color:var(--ac);color:var(--ac);background:var(--acd);box-shadow:0 0 10px var(--acg)}

#gear-tray{
  display:flex;align-items:center; /* v7.5: restored from v7.3 — flex-start caused jump */
  gap:5px;
  overflow:visible;
  max-width:0;opacity:0;
  transition:max-width var(--gear-tr), opacity var(--gear-tr);
  white-space:nowrap;
  padding-right:6px;
}
#gear-tray.open{max-width:500px;opacity:1;}

/* Gear tray buttons */
.gt-btn{
  background:var(--s3);color:var(--t0);border:1px solid var(--bd);
  padding:3px 8px;font-family:var(--fm);font-size:.71rem;
  letter-spacing:.04em;white-space:nowrap;transition:background var(--tr),border-color var(--tr),color var(--tr),box-shadow var(--tr);
  height:28px;display:flex;align-items:center;flex-shrink:0;
}
.gt-btn:hover{background:var(--s5);border-color:var(--ac);color:var(--ac)}
/* v7.5: NO transform on :active — prevents icon/menu jump */

/* History button — purple */
.gt-btn.hist-btn{border-color:var(--iod);color:var(--io)}
.gt-btn.hist-btn:hover{background:var(--iog);border-color:var(--io)}

/* Theme button — purple */
.gt-btn.theme-btn{border-color:var(--iod);color:var(--io)}
.gt-btn.theme-btn:hover{background:var(--iog);border-color:var(--io)}
.gt-btn.theme-btn.open{border-color:var(--io);background:var(--iog)}

/* ── v7.5: BGM Hitbox ────────────────────────────────────────────
   Architecture change from v7.4:
   • #bgm-column wrapper removed — caused flex-start alignment bug
   • #bgm-hitbox is position:relative; contains the ♫ button normally
     in the flex flow (height:28px like all other .gt-btn elements)
   • #bgm-slider-wrap is position:ABSOLUTE top:100% left:0 right:0
     so it drops below the taskbar without affecting any flex layout
   • .vol-open class toggled on #bgm-hitbox (not a child) by JS
   • Hitbox covers both button + slider area via pseudo-element bridge
     so mouseleave only fires when cursor truly exits the rectangle
────────────────────────────────────────────────────────────────── */
#bgm-hitbox{
  position:relative;
  flex-shrink:0;
  display:flex;
  align-items:center;   /* matches gear-tray align-items:center */
}

/* The BGM toggle button — standard gt-btn size, in normal flex flow */
.gt-btn.bgm-btn{
  border-color:var(--gnd);color:var(--t1);
  min-width:auto;height:28px;
  justify-content:center;padding:3px 9px;
  font-size:.88rem;
  flex-shrink:0;
}
.gt-btn.bgm-btn:hover{background:var(--gnd);border-color:var(--gn);color:var(--gn)}
.gt-btn.bgm-btn.on{
  border-color:var(--gn);color:var(--gn);
  background:var(--gnd);box-shadow:0 0 7px rgba(0,255,136,.2);
}

/* Slider panel — absolutely positioned below #bgm-hitbox.
   Collapsed (height:0) by default; .vol-open on #bgm-hitbox shows it. */
#bgm-slider-wrap{
  position:absolute;
  top:100%;           /* flush below the button, zero gap */
  left:0;
  right:0;            /* inherits width of #bgm-hitbox = button width */
  height:0;
  overflow:hidden;
  opacity:0;
  pointer-events:none;
  transition:height .2s ease, opacity .18s ease;
  /* Visual box */
  background:var(--s2);
  border:1px solid var(--bd2);
  border-top:none;
  box-sizing:border-box;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:13px 0;
}
#bgm-hitbox.vol-open #bgm-slider-wrap{
  height:106px;       /* 80px slider + 13px padding top + 13px bottom */
  opacity:1;
  pointer-events:all;
}
/* Invisible pseudo-element bridge fills the gap between button bottom
   and slider panel top so mouseleave doesn't fire mid-transition.     */
#bgm-hitbox.vol-open::after{
  content:'';
  position:absolute;
  top:100%;
  left:0;right:0;
  height:2px;          /* covers the border seam */
  background:transparent;
  pointer-events:all;
}

/* ── Fill track + fill bar ───────────────────────────────────── */
#vol-fill-track{
  position:absolute;
  left:50%;
  transform:translateX(-50%);
  top:13px;
  bottom:13px;
  width:4px;
  background:var(--bd2);
  border-radius:2px;
  pointer-events:none;
  overflow:hidden;
}
/* Green fill grows from bottom. JS sets --vol-pct on #bgm-slider-wrap */
#vol-fill-bar{
  position:absolute;
  bottom:0;left:0;right:0;
  height:calc(var(--vol-pct, 70) * 1%);
  background:var(--gn);
  border-radius:2px;
  transition:height .08s linear;
}

/* ── Vertical range input — transparent overlay over the fill ── */
#bgm-volume{
  -webkit-appearance:none;
  appearance:none;
  writing-mode:vertical-lr;
  direction:rtl;
  width:100%;          /* fills full width of slider-wrap = button width */
  height:80px;
  cursor:pointer;
  background:transparent;
  outline:none;
  position:relative;
  z-index:1;
}
#bgm-volume::-webkit-slider-runnable-track{
  width:4px;background:transparent;border-radius:2px;
}
#bgm-volume::-moz-range-track{
  width:4px;background:transparent;border-radius:2px;
}
/* No thumb — fill bar is the only visual */
#bgm-volume::-webkit-slider-thumb{
  -webkit-appearance:none;
  width:0;height:0;background:transparent;border:none;box-shadow:none;
}
#bgm-volume::-moz-range-thumb{
  width:0;height:0;background:transparent;border:none;box-shadow:none;
}

/* Save/Load button — cyan accent */
.gt-btn.sl-btn{border-color:var(--acd);color:var(--ac)}
.gt-btn.sl-btn:hover{background:var(--acg);box-shadow:0 0 8px var(--acg)}

.gt-div{display:block;width:1px;height:22px;background:var(--bd2);flex-shrink:0}

/* ── Theme flyout ─────────────────────────────────────────────── */
.gt-item-wrap{
  position:relative;flex-shrink:0;
}
.gt-flyout{
  position:absolute;
  top:calc(100% + 3px);
  left:0;
  width:100%;
  background:var(--s2);border:1px solid var(--bd2);
  display:flex;flex-direction:column;
  z-index:600;
  max-height:0;overflow:hidden;opacity:0;
  transition:max-height .18s ease, opacity .18s ease;
}
.gt-flyout.open{max-height:200px;opacity:1;}
.tf-opt{
  background:none;border:none;color:var(--t1);
  font-family:var(--fm);font-size:.71rem;
  padding:6px 8px;text-align:center;
  transition:all var(--tr);white-space:nowrap;width:100%;
}
/* v7.0: Classic/Light/Dark hover — more distinct colors per theme */
.tf-opt:hover{background:var(--s4);color:var(--ac)}
[data-theme="classic"] .tf-opt:hover{background:var(--s4);color:var(--ac)}
[data-theme="classic"] .tf-opt[data-theme="dark"]:hover{
  background:#09131e;
  color:#7fd2ff;
  box-shadow:inset 0 0 0 1px #1b3a57;
}
[data-theme="dark"] .tf-opt:hover{background:#202c44;color:#60c8f0}
.tf-opt.active{color:var(--ac);background:var(--acd)}
.tf-opt[data-theme="classic"]{text-align:center}

#file-pick{display:none}

/* ═══════════════════════════════════════════════════════════════
   SAVE/LOAD MODAL — v7.1 (4×3 slots, 4-col controls, no X btn)
═══════════════════════════════════════════════════════════════ */
#sl-overlay{
  position:fixed;inset:0;z-index:500;
  background:var(--overlay);
  display:flex;align-items:center;justify-content:center;
  padding:20px 14px;
  /* v7.1: prevent clicks passing through overlay to background */
  pointer-events:all;
}
#sl-overlay.hidden{
  display:none;
  pointer-events:none;
}

#sl-box{
  background:var(--modal-bg);border:1px solid var(--modal-bd);
  /* v7.1: wider to comfortably fit 4 columns */
  width:clamp(640px, 60vw, 1060px);
  max-width:94vw;
  min-height:min(54vh, 680px);
  max-height:90vh;
  overflow-y:auto;
  padding:18px 18px 16px;
  border-radius:10px;
  box-shadow:0 0 60px rgba(0,0,0,.95);
  display:flex;flex-direction:column;gap:12px;
  /* Stop clicks inside modal from reaching overlay */
  pointer-events:all;
}
#sl-header{
  display:flex;align-items:center;
  /* v7.1: no close button, so title is alone */
  justify-content:flex-start;
  padding-bottom:10px;border-bottom:1px solid var(--bd2);
}
#sl-title{
  font-family:var(--fd);font-size:.82rem;color:var(--ac);
  letter-spacing:.18em;
}
/* v7.1: #sl-close removed from HTML; keep rule harmless if JS re-adds it */
#sl-close{display:none}

/* v7.1: Slot area — 4 columns × 3 rows */
#sl-slots{
  display:grid;
  grid-template-columns:repeat(4,minmax(0,1fr));
  gap:10px;
  align-content:start;
  min-height:300px;
}

/* Slot card */
.sl-slot{
  background:linear-gradient(165deg,var(--s2),var(--s1));
  border:1px solid var(--bd);
  border-radius:8px;
  padding:10px 11px 9px;
  display:flex;flex-direction:column;gap:4px;
  cursor:pointer;transition:border-color var(--tr),background var(--tr),transform var(--tr);
  position:relative;min-height:108px;
}
.sl-slot:hover{border-color:var(--acd);background:var(--s3)}
.sl-slot.active{
  border-color:var(--ac);
  box-shadow:0 0 0 1px var(--ac), 0 0 12px var(--acg);
  /* v7.5: transform removed — no upward jump when selecting slot */
}
.sl-slot.empty{
  border-style:dashed;
  background:
    repeating-linear-gradient(-45deg,var(--s2),var(--s2) 6px,var(--s1) 6px,var(--s1) 12px);
}

.sl-slot-head{
  display:flex;align-items:center;justify-content:space-between;gap:6px;
}
.sl-slot-num{
  font-family:var(--fd);font-size:.6rem;color:var(--t2);letter-spacing:.11em;
}
.sl-slot-state{
  font-size:.56rem;color:var(--gn);letter-spacing:.08em;text-transform:uppercase;
}
.sl-slot.empty .sl-slot-state{color:var(--t3)}

.sl-slot-name{
  background:transparent;border:none;border-bottom:1px solid var(--bd2);
  color:var(--t0);font-family:var(--fm);font-size:.72rem;
  width:100%;padding:2px 2px 3px;outline:none;
  transition:border-color var(--tr);
}
.sl-slot-name:focus{border-color:var(--ac)}
.sl-slot-name::placeholder{color:var(--t3)}

.sl-slot-meta{
  margin-top:auto;
  display:flex;
  flex-direction:column;
  gap:2px;
  font-size:.62rem;
  color:var(--t2);
}
.sl-slot-meta-row{
  display:flex;align-items:center;justify-content:space-between;gap:8px;
}
.sl-slot-meta-row span:last-child{color:var(--t0)}

/* v7.4: Control panel — strict 4×2 grid
   Row 1: セーブ · 書き出し · 読み込み · 削除
   Row 2: プレイ · 新しくプレイ · [empty] · 戻る             */
#sl-controls{
  display:grid;
  grid-template-columns:repeat(4,minmax(0,1fr));
  gap:8px;
  padding-top:6px;
  border-top:1px solid var(--bd2);
}
/* Empty placeholder cells in bottom row */
.sl-act-empty{
  display:block;
  /* visually invisible, takes up grid space */
}
.sl-act{
  background:var(--s3);border:1px solid var(--bd);
  color:var(--t0);font-family:var(--fm);font-size:.72rem;
  letter-spacing:.06em;padding:9px 8px;
  transition:all var(--tr);
}
.sl-act:hover{border-color:var(--acd);color:var(--ac);background:var(--s2)}
.sl-act.ac{border-color:var(--acd);color:var(--ac)}
.sl-act.ac:hover{background:var(--acg)}
.sl-act.io{border-color:var(--iod);color:var(--io)}
.sl-act.io:hover{background:var(--iog);border-color:var(--io)}
.sl-act.dn{border-color:var(--rdd);color:var(--rd)}
.sl-act.dn:hover{background:rgba(255,51,85,.1);border-color:var(--rd)}
.sl-act.yw{border-color:var(--ywd);color:var(--yw)}
.sl-act.yw:hover{background:rgba(255,215,0,.1);border-color:var(--yw)}
/* v7.2: Play button — lime green (#32CD32) */
.sl-act.gn{
  background:#1a4d1a;
  border-color:#32CD32;
  color:#32CD32;
}
.sl-act.gn:hover{background:#32CD32;color:#000;border-color:#32CD32}

/* v7.3: "新しくプレイ" (Slot 0 / Guest) — always enabled, brighter accent */
.sl-act-new{
  border-color:#32CD32!important;
  color:#32CD32!important;
  background:rgba(50,205,50,.12)!important;
  letter-spacing:.03em;
  box-shadow:0 0 0 1px rgba(50,205,50,.25);
}
.sl-act-new:hover{
  background:#32CD32!important;
  color:#000!important;
  box-shadow:0 0 10px rgba(50,205,50,.5);
}
/* Disabled slot actions (JS adds .sl-act-disabled) */
.sl-act-disabled{
  opacity:.32;
  pointer-events:none;
  cursor:not-allowed;
}

@media (max-width: 1000px){
  #sl-slots{grid-template-columns:repeat(3,minmax(0,1fr))}
  /* sl-controls stays 4-col at 1000px — 4 buttons fit fine */
}
@media (max-width: 700px){
  #sl-box{
    width:min(94vw,700px);
    min-height:auto;
    padding:14px 12px 12px;
  }
  #sl-slots{grid-template-columns:repeat(2,minmax(0,1fr));min-height:auto}
  #sl-controls{grid-template-columns:repeat(2,minmax(0,1fr))}
  .sl-act-empty{display:none}
}

/* ═══════════════════════════════════════════════════════════════
   MAIN APP
═══════════════════════════════════════════════════════════════ */
#app{
  padding:15px 18px;max-width:1660px;margin:0 auto;
  min-height:calc(100vh - var(--tbh));
}
.pg-hdr{
  display:flex;align-items:baseline;gap:12px;
  margin-bottom:13px;padding-bottom:8px;border-bottom:1px solid var(--bd);
}
.pg-title{font-family:var(--fd);font-size:.98rem;font-weight:700;letter-spacing:.1em}
.pg-sub{font-size:.74rem;color:var(--t1)}
.back-btn{
  display:inline-flex;align-items:center;gap:5px;
  background:none;border:1px solid var(--bd);color:var(--t1);
  padding:3px 10px;font-size:.71rem;letter-spacing:.04em;
  margin-bottom:10px;transition:all var(--tr);
}
.back-btn:hover{border-color:var(--ac);color:var(--ac)}

/* Buttons */
.btn{
  background:var(--s3);color:var(--t0);border:1px solid var(--bd);
  padding:3px 9px;font-family:var(--fm);font-size:.72rem;
  transition:all var(--tr);white-space:nowrap;
}
.btn:hover{border-color:var(--ac);color:var(--ac)}
.btn:active{transform:scale(.97)}
.btn-sm{padding:2px 7px;font-size:.67rem}
.btn-ac{border-color:var(--acd);color:var(--ac)}
.btn-ac:hover{background:var(--acg)}
.btn-dn{border-color:var(--rdd);color:var(--rd)}
.btn-dn:hover{background:rgba(255,51,85,.1);border-color:var(--rd)}
.btn-yw{border-color:var(--ywd);color:var(--yw)}
.btn-yw:hover{background:rgba(255,215,0,.08);border-color:var(--yw)}
.btn-io{border-color:var(--iod);color:var(--io)}
.btn-io:hover{background:var(--iog);border-color:var(--io)}
.btn-gn{border-color:var(--gnd);color:var(--gn)}
.btn-gn:hover{background:rgba(0,255,136,.08);border-color:var(--gn)}

.fi,.fs,.fta{
  background:var(--s2);border:1px solid var(--bd);
  color:var(--t0);font-family:var(--fm);font-size:.77rem;
  padding:4px 8px;transition:border-color var(--tr);
}
.fi:focus,.fs:focus,.fta:focus{outline:none;border-color:var(--acd)}
.fs option{background:var(--s2)}
.fi::placeholder{color:var(--t3)}

.srch-row{display:flex;gap:7px;align-items:center;margin-bottom:9px}
.srch-row .fi{flex:1}

/* ═══════════════════════════════════════════════════════════════
   RANK & COLOUR HELPERS
═══════════════════════════════════════════════════════════════ */
.rA{color:var(--rA)} .rB{color:var(--rB)} .rC{color:var(--rC)}
.rD{color:var(--rD)} .rE{color:var(--rE)}
.blA{border-left:2px solid var(--rA)} .blB{border-left:2px solid var(--rB)}
.blC{border-left:2px solid var(--rC)} .blD{border-left:2px solid var(--rD)}
.blE{border-left:2px solid var(--rE)}
.pos{color:var(--gn)} .neg{color:var(--rd)} .neu{color:var(--t1)}
.dim{color:var(--t3)}

/* ═══════════════════════════════════════════════════════════════
   HOME PAGE
═══════════════════════════════════════════════════════════════ */
.home-bar{
  display:flex;align-items:center;gap:10px;flex-wrap:wrap;
  padding:5px 10px;background:var(--s2);border:1px solid var(--bd);
  margin-bottom:11px;font-size:.71rem;color:var(--t2);
}
.hm-slot{
  background:var(--acd);color:var(--ac);border:1px solid var(--acd);
  padding:1px 8px;font-family:var(--fd);font-size:.62rem;letter-spacing:.1em;
}
.hm-right{margin-left:auto;display:flex;gap:10px}
.hm-link{cursor:pointer;color:var(--ac)}
.hm-link:hover{text-decoration:underline}
.hm-link-cls{color:var(--ac)}
.hm-link-cls:hover{text-decoration:underline}

.grade-block{background:var(--s1);border:1px solid var(--bd);margin-bottom:7px}
.grade-hdr{
  display:flex;align-items:center;gap:10px;
  padding:7px 12px;cursor:pointer;border-bottom:1px solid var(--bd);
  transition:background var(--tr);
}
.grade-hdr:hover{background:var(--s2)}
.grade-hdr:hover .grade-lbl{color:var(--ac)}
.grade-lbl{font-family:var(--fd);font-size:.87rem;font-weight:700;color:var(--t1);letter-spacing:.1em}
.grade-hint{font-size:.62rem;color:var(--t3);margin-left:auto}

.cls-strip{display:grid;grid-template-columns:repeat(5,1fr);gap:5px;padding:6px 8px;overflow:hidden}
@media(max-width:700px){.cls-strip{grid-template-columns:repeat(3,1fr)}}
@media(max-width:420px){.cls-strip{grid-template-columns:repeat(2,1fr)}}
.cls-mini{
  background:var(--s2);border:1px solid var(--bd);
  padding:7px 9px;cursor:pointer;
  transition:all var(--tr);position:relative;display:flex;flex-direction:column;gap:2px;
}
.cls-mini:hover{border-color:var(--ac);background:var(--s4)}
.mini-rank{position:absolute;top:4px;right:6px;font-family:var(--fd);font-size:.8rem;font-weight:700}
.mini-name{font-size:.68rem;color:var(--t1);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:calc(100% - 18px)}
.mini-cp{font-family:var(--fd);font-size:1.02rem;font-weight:700}
.mini-cplbl{font-size:.58rem;color:var(--t3)}

.dist-row{display:flex;align-items:center;gap:3px;margin-top:5px;padding-top:4px;border-top:1px solid var(--bd)}
.dist-inp{
  background:var(--s3);border:1px solid var(--bd);
  color:var(--t0);font-family:var(--fm);font-size:.67rem;
  padding:2px 4px;width:62px;text-align:center;
}
.dist-inp:focus{outline:none;border-color:var(--acd)}
.dist-btn{
  background:var(--s3);border:1px solid var(--bd);
  color:var(--t2);font-family:var(--fm);font-size:.62rem;
  padding:2px 5px;white-space:nowrap;transition:all var(--tr);
}
.dist-btn:hover{border-color:var(--yw);color:var(--yw)}

.sp-tiles{display:flex;gap:7px;margin-top:7px}
.sp-tile{flex:1;background:var(--s1);border:1px solid var(--bd);padding:9px 12px;cursor:pointer;transition:background var(--tr)}
.sp-tile:hover{background:var(--s2)}
.sp-cnt{font-family:var(--fd);font-size:1.05rem;font-weight:700}
.sp-lbl{font-size:.63rem;color:var(--t2);margin-top:3px}

/* ═══════════════════════════════════════════════════════════════
   HISTORY PAGE
═══════════════════════════════════════════════════════════════ */
.hist-list{
  display:flex;flex-direction:column;gap:3px;
  margin-top:8px;
}
.hist-row{
  display:grid;
  grid-template-columns:180px 70px 1fr 1fr;
  align-items:center;
  gap:10px;
  padding:6px 12px;
  background:var(--s1);border:1px solid var(--bd);
  transition:background var(--tr);
}
.hist-row:hover{background:var(--s2)}
.hist-row-date{
  font-family:var(--fd);font-size:.74rem;color:var(--ac);
  letter-spacing:.06em;white-space:nowrap;
}
.hist-row-idx{
  font-size:.62rem;color:var(--t3);text-align:right;white-space:nowrap;
}
.hist-row-cls{
  font-size:.71rem;color:var(--t1);
}
.hist-row-cls span{color:var(--t0)}
.hist-row-stu{
  font-size:.71rem;color:var(--t1);text-align:right;
}
.hist-row-stu span{color:var(--t0)}
.hist-empty{
  font-size:.71rem;color:var(--t3);text-align:center;padding:30px;
}

/* ═══════════════════════════════════════════════════════════════
   GRADE PAGE
═══════════════════════════════════════════════════════════════ */
.cls-row{background:var(--s1);border:1px solid var(--bd);margin-bottom:7px}
.cls-row-hdr{
  display:grid;grid-template-columns:50px 155px 1fr auto;
  align-items:center;gap:12px;padding:9px 13px;cursor:pointer;
  border-bottom:1px solid var(--bd);transition:background var(--tr);
}
.cls-row-hdr:hover{background:var(--s2)}
.cls-rnk-lg{font-family:var(--fd);font-size:1.5rem;font-weight:900}
.cls-info{display:flex;flex-direction:column;gap:2px}
.cls-i-nm{font-size:.85rem;font-weight:500;color:var(--t1);font-family:var(--fj)}
.cls-i-cp{font-family:var(--fd);font-size:1rem;color:var(--t0)}
.cls-i-cp small{font-size:.6rem;color:var(--t3);margin-left:4px}
.cls-rmeta{font-size:.66rem;color:var(--t2);text-align:right}

.grade-pg-hdr{
  display:flex;align-items:baseline;justify-content:space-between;gap:12px;
  margin-bottom:13px;padding-bottom:8px;border-bottom:1px solid var(--bd);
}
.grade-pg-hdr-left{display:flex;align-items:baseline;gap:12px}

.kp-strip{display:flex;gap:6px;padding:10px 13px;overflow-x:auto;flex-wrap:nowrap}

.kp-card{
  background:var(--s2);border:1px solid var(--bd);
  padding:7px 12px;min-width:210px;flex-shrink:0;
  cursor:pointer;transition:all var(--tr);
  display:flex;align-items:center;gap:10px;
}
.kp-card:hover{border-color:var(--acd);background:var(--s3)}
.kp-name{
  font-size:.88rem;color:var(--t0);font-family:var(--fj);
  white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
  font-weight:500;flex:1;min-width:0;
}
.kp-pp-val{
  font-family:var(--fd);font-size:.84rem;font-weight:700;
  white-space:nowrap;flex-shrink:0;
}
.kp-prp-val{
  font-family:var(--fd);font-size:.76rem;font-weight:600;
  color:var(--yw);white-space:nowrap;flex-shrink:0;
}

/* ═══════════════════════════════════════════════════════════════
   CLASS PAGE
═══════════════════════════════════════════════════════════════ */
.cls-pg-top{display:flex;align-items:flex-start;gap:14px;margin-bottom:11px;flex-wrap:wrap}
.cls-pg-left{flex:1;min-width:0}
.cls-nm-edit{display:flex;align-items:center;gap:6px;margin-top:5px}
.cls-nm-edit label{font-size:.66rem;color:var(--t2);white-space:nowrap}
.cls-nm-inp{
  background:var(--s2);border:1px solid var(--bd);
  color:var(--ac);font-family:var(--fd);font-size:.76rem;
  padding:3px 7px;width:185px;
}
.cls-nm-inp:focus{outline:none;border-color:var(--ac)}
.cp-ctrl{display:flex;align-items:center;gap:5px;flex-wrap:wrap}
.cp-ctrl label{font-size:.69rem;color:var(--t1)}

.bulk-bar{
  display:flex;align-items:center;gap:6px;flex-wrap:wrap;
  padding:5px 10px;background:var(--s2);border:1px solid var(--bd2);margin-bottom:8px;
}
.bulk-bar label{font-size:.71rem;color:var(--t1)}
.bulk-cnt{font-family:var(--fd);font-size:.71rem;color:var(--ac);min-width:60px}
.bulk-inp{width:90px}
.cls-pp-lbl{font-size:calc(0.71rem * 1.2)}

/* Student grid */
.s-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:4px}
@media(max-width:1100px){.s-grid{grid-template-columns:repeat(4,1fr)}}
@media(max-width:820px){.s-grid{grid-template-columns:repeat(3,1fr)}}
@media(max-width:560px){.s-grid{grid-template-columns:repeat(2,1fr)}}

.s-card{
  background:var(--s1);border:1px solid var(--bd);
  cursor:pointer;
  transition:border-color var(--tr),background var(--tr);
  position:relative;user-select:none;
  display:grid;
  grid-template-columns:3fr 2fr;
  grid-template-rows:1fr 3fr;
  min-height:86px;
  overflow:hidden;
}
.s-card:hover{border-color:var(--acd);background:var(--s2)}
.s-card.expelled{opacity:.27;border-style:dashed}
.s-card.selected{border-color:var(--yw);background:rgba(255,215,0,.05)}

/* v7.0: Drag & Drop states */
.s-card[draggable="true"]{cursor:grab}
.s-card[draggable="true"]:active{cursor:grabbing}
.s-card.dragging{opacity:.35;border-color:var(--ac);border-style:dashed}
.s-card.drag-over{border-color:var(--gn);box-shadow:0 0 8px rgba(0,255,136,.35);background:rgba(0,255,136,.06)}
.swap-mode .s-card:not(.expelled){border-color:var(--t3)}
.swap-mode .s-card:not(.expelled):hover{border-color:var(--gn);background:rgba(0,255,136,.04)}

.s-chk{
  position:absolute;top:3px;right:3px;
  width:13px;height:13px;
  border:1px solid var(--bd2);background:var(--s3);
  display:none;align-items:center;justify-content:center;
  font-size:.52rem;color:var(--yw);z-index:2;
}
.sel-mode .s-card .s-chk{display:flex}
.s-card.selected .s-chk{border-color:var(--yw);background:rgba(255,215,0,.14)}

.s-top-left{
  grid-column:1;grid-row:1;
  display:flex;align-items:center;gap:5px;
  padding:5px 5px 1px 6px;
}
.s-sid{
  font-size:.82rem;color:var(--t2);letter-spacing:.02em;font-family:var(--fm);
  white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
}
.s-gender{font-size:.80rem;color:var(--t1);font-family:var(--fm);flex-shrink:0;}

.s-top-right{
  grid-column:2;grid-row:1;
  display:flex;align-items:flex-start;justify-content:flex-end;
  padding:5px 6px 1px 2px;
}
.s-prp-val{
  font-family:var(--fd);font-size:.91rem;font-weight:700;
  color:var(--yw);white-space:nowrap;line-height:1;
}
.s-prp-unit{
  color:#ffffff;font-size:.60rem;font-family:var(--fm);
  margin-left:2px;opacity:.88;font-weight:normal;
}

.s-bot-left{
  grid-column:1;grid-row:2;
  display:flex;align-items:flex-end;
  padding:0 4px 6px 6px;min-width:0;
}
.s-name{
  font-size:1.62rem;
  color:var(--t0);font-family:var(--fj);
  font-weight:700;line-height:1.05;
  word-break:break-all;
  overflow:hidden;
  display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;
}

.s-bot-right{
  grid-column:2;grid-row:2;
  display:flex;align-items:flex-end;justify-content:flex-end;
  padding:0 6px 6px 2px;
}
.s-pp-val{
  font-family:var(--fd);font-size:1.08rem;font-weight:700;
  white-space:nowrap;line-height:1.1;
}
.s-pp-unit{
  color:#ffffff;font-size:calc(0.62rem * 1.2);font-family:var(--fm);
  margin-left:2px;opacity:.88;font-weight:normal;
}

.alt-hdr{display:flex;align-items:center;gap:8px;margin:12px 0 6px}
.alt-hdr span{font-size:.63rem;color:var(--t2);white-space:nowrap;letter-spacing:.08em}
.alt-hdr hr{flex:1;border:none;border-top:1px solid var(--bd)}

/* ═══════════════════════════════════════════════════════════════
   RANKING PAGE — v7.3
   Table now shows all 9 sortable stats as thead columns.
   Mini-bar column removed; colgroup gives each stat 48px.
═══════════════════════════════════════════════════════════════ */
.rnk-wrap{overflow-x:auto}
.rnk-tbl{
  width:100%;border-collapse:collapse;font-size:.72rem;
  table-layout:fixed;
}
/* Fixed column widths — stat columns are intentionally compact */
.rnk-tbl col.col-rank  { width:46px }
.rnk-tbl col.col-name  { width:130px }
.rnk-tbl col.col-class { width:110px }
/* 9 stat columns: PP, PRP, 言語, 推論, 記憶, 思考, 身体, 精神, 総合 */
.rnk-tbl col.col-pp    { width:68px }
.rnk-tbl col.col-prp   { width:52px }
.rnk-tbl col.col-s0,
.rnk-tbl col.col-s1,
.rnk-tbl col.col-s2,
.rnk-tbl col.col-s3,
.rnk-tbl col.col-s4,
.rnk-tbl col.col-s5,
.rnk-tbl col.col-ov    { width:48px }

.rnk-tbl th{
  padding:4px 6px;border-bottom:2px solid var(--bd2);
  color:var(--t2);font-weight:normal;font-size:.63rem;
  letter-spacing:.03em;text-align:right;
  background:var(--s1);white-space:nowrap;cursor:pointer;
  transition:color var(--tr);
  overflow:hidden;text-overflow:ellipsis;
  user-select:none;
}
/* Name and class columns are left-aligned */
.rnk-tbl th.th-left{ text-align:left }
.rnk-tbl th:hover{color:var(--ac)}
.rnk-tbl th.sort-active{color:var(--ac)}
.rnk-tbl th .sort-arrow{
  display:inline-block;
  font-size:.55rem;margin-left:2px;
  width:.6em;text-align:center;
  opacity:.6;vertical-align:middle;
}
.rnk-tbl th.sort-active .sort-arrow{ opacity:1; color:var(--ac); }

.rnk-tbl td{
  padding:4px 6px;border-bottom:1px solid var(--bd);
  color:var(--t1);transition:background var(--tr);
  overflow:hidden;text-overflow:ellipsis;white-space:nowrap;
  text-align:right;
}
.rnk-tbl td.td-left{ text-align:left }
.rnk-tbl tbody tr:hover td{background:var(--s2);color:var(--t0)}
/* Stat cell highlight when that column is the active sort */
.rnk-tbl td.stat-active{ color:var(--ac);font-weight:600; }

/* v7.6: .rnk-num class no longer overrides font — removed.
   Ranking numeric cells (PP, PRP, stats, overall, rank#) use the
   standard .rnk-tbl td base: font-family:var(--fm), font-size:.72rem.
   This is the clean v7.4 style applied consistently to all columns. */

.rn{font-family:var(--fd);font-size:.8rem;color:var(--t0);text-align:right;padding-right:10px!important}
.rn.top3{color:var(--yw)}
.rk-pp{font-family:var(--fd);color:var(--gn)}
.rk-pp.neg{color:var(--rd)}
.rk-nm{cursor:pointer;color:var(--ac)}
.rk-nm:hover{text-decoration:underline}
.medal-row{display:flex;gap:8px;margin-top:12px;flex-wrap:wrap}
.medal-card{background:var(--s2);border:1px solid var(--bd);padding:10px 14px;flex:1;min-width:170px}
.medal-card[style*="cursor:pointer"]:hover{border-color:var(--ac);background:var(--s3)}
.medal-rnk{font-size:.67rem;color:var(--t2);margin-bottom:3px}
.medal-name{font-family:var(--fj);font-size:.85rem;color:var(--t0);margin-bottom:3px}
.medal-pp{font-family:var(--fd);font-size:1.08rem;color:var(--gn)}

/* v7.3: Sort bar — labels now doubled as table headers; keep bar as quick-access row */
.rnk-sort-bar{
  display:flex;align-items:center;gap:6px;flex-wrap:wrap;
  padding:5px 10px;background:var(--s2);border:1px solid var(--bd);
  margin-bottom:9px;font-size:.68rem;color:var(--t2);
}
.rnk-sort-bar label{color:var(--t2);white-space:nowrap}
.rnk-sort-btn{
  background:var(--s3);border:1px solid var(--bd);
  color:var(--t1);font-family:var(--fm);font-size:.65rem;
  padding:2px 7px;transition:all var(--tr);white-space:nowrap;
}
.rnk-sort-btn:hover{border-color:var(--ac);color:var(--ac)}
.rnk-sort-btn.active{border-color:var(--ac);color:var(--ac);background:var(--acd)}

/* ═══════════════════════════════════════════════════════════════
   CLASS RANKING TABLE
═══════════════════════════════════════════════════════════════ */
.cls-rnk-section{margin-top:12px}
.cls-rnk-tbl{width:100%;border-collapse:collapse;font-size:.77rem}
.cls-rnk-tbl th{
  padding:5px 10px;border-bottom:2px solid var(--bd2);
  color:var(--t2);font-weight:normal;letter-spacing:.06em;text-align:left;
  background:var(--s1);white-space:nowrap;
}
.cls-rnk-tbl td{
  padding:5px 10px;border-bottom:1px solid var(--bd);
  color:var(--t1);transition:background var(--tr);
}
.cls-rnk-tbl tbody tr:hover td{background:var(--s2);color:var(--t0)}
.cls-rnk-tbl .rn{font-family:var(--fd);font-size:.8rem;color:var(--t0);text-align:right;padding-right:12px!important}
.cls-rnk-tbl .rn.top3{color:var(--yw)}
.cls-rnk-tbl .rk-cp{font-family:var(--fd);color:var(--gn);text-align:right;white-space:nowrap}
.cls-rnk-tbl .rk-nm{cursor:pointer;color:var(--ac)}
.cls-rnk-tbl .rk-nm:hover{text-decoration:underline}

.medal-sub{
  font-size:.67rem;color:var(--t2);margin-top:1px;margin-bottom:3px;
  font-family:var(--fm);letter-spacing:.03em;
}

/* ═══════════════════════════════════════════════════════════════
   PROFILE PAGE — v7.1
═══════════════════════════════════════════════════════════════ */
#prof-wrap{display:grid;grid-template-columns:280px 1fr;gap:12px}
@media(max-width:800px){#prof-wrap{grid-template-columns:1fr}}

.prof-side{
  background:var(--s1);border:1px solid var(--bd);padding:14px;
  align-self:start;position:sticky;top:calc(var(--tbh) + 8px);
}
.prof-main{display:flex;flex-direction:column;gap:9px}

.prof-side-hdr{
  font-family:var(--fd);font-size:.62rem;color:var(--t1);
  letter-spacing:.18em;text-transform:uppercase;
  margin-bottom:6px;
}
.prof-side-sep{
  border:none;border-top:1px solid var(--bd2);
  margin-bottom:10px;
}

.prof-name{
  font-family:var(--fd);font-size:1.86rem;
  font-weight:900;color:var(--t0);
  margin-bottom:5px;
  word-break:break-all;line-height:1.1;
}
.prof-sid{font-size:.62rem;color:var(--t3);margin-bottom:7px}
.badge{display:inline-block;font-size:.58rem;padding:1px 6px;border:1px solid;letter-spacing:.07em;margin-bottom:8px}
.bd-in{border-color:var(--gn);color:var(--gn)}
.bd-ex{border-color:var(--rd);color:var(--rd)}
.bd-gr{border-color:var(--yw);color:var(--yw)}
.bd-ic{border-color:var(--ac);color:var(--ac)}
.prof-pp{font-family:var(--fd);font-size:1.2rem;font-weight:700;margin:6px 0 1px}
.prof-pp.pos{color:var(--gn)}
.prof-pp.neg{color:var(--rd)}
.prof-pplbl{font-size:.58rem;color:var(--t3)}
.label-faded{color:var(--t2)!important;font-style:italic}

.info-tbl{width:100%;border-collapse:collapse;margin-top:8px}
.info-tbl td{padding:3px 0;border-bottom:1px solid var(--bd);font-size:.71rem}
.info-tbl td:first-child{color:var(--t2);width:46%}
.info-tbl td:last-child{color:var(--t0);text-align:right}

/* v7.1: stat bars — hide numerical value (.sb-val hidden) */
.sb-grid{margin-top:8px}
.sb-row{display:flex;align-items:center;gap:6px;margin-bottom:4px}
.sb-lbl{font-size:.62rem;color:var(--t2);width:48px;flex-shrink:0}
.sb-track{flex:1;height:5px;background:var(--bd)}
.sb-fill{height:100%;background:var(--ac);transition:width .3s}
/* v7.1: numerical value next to stat name hidden */
.sb-val{display:none}
.sb-grade{
  font-family:var(--fd);font-size:.66rem;font-weight:700;
  width:28px;text-align:center;flex-shrink:0;
}
/* letter-grade color tiers */
.sg-sp{color:#ff9f00} .sg-s{color:#ffd700} .sg-ap{color:#a0ff80}
.sg-a{color:#00ff88}  .sg-am{color:#00e07a} .sg-bp{color:#00c8ff}
.sg-b{color:#60b8ff}  .sg-bm{color:#7498b2} .sg-cp{color:#a0b8c8}
.sg-c{color:#8090a0}  .sg-cm{color:#607080} .sg-dp{color:#506070}
.sg-d{color:#405060}  .sg-dm{color:#304050}

/* v7.2: Overall score block — transparent, no border (floats on .prof-side bg) */
.ov-wrap{
  display:flex;align-items:stretch;gap:10px;margin-top:10px;
}
.ov-score-block{
  flex:0 0 70px;
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  background:transparent;border:none;padding:8px 4px;
}
.ov-score-lbl{font-size:.55rem;color:var(--t2);letter-spacing:.09em;margin-bottom:4px}
.ov-score-val{
  font-family:var(--fd);font-size:1.6rem;font-weight:900;
  color:var(--ac);line-height:1;
}
.ov-score-sub{font-size:.55rem;color:var(--t3);margin-top:3px}

/* v7.2: Radar chart — transparent, no border; canvas still constrained */
.radar-wrap{
  flex:1;
  display:flex;align-items:center;justify-content:center;
  background:transparent;border:none;
  padding:6px;
  overflow:hidden;
  min-width:0;
}
.radar-wrap canvas{
  display:block;
  max-width:100%;
  max-height:100%;
  width:auto !important;
  height:auto !important;
}

.prof-sec{background:var(--s1);border:1px solid var(--bd);padding:11px 13px}
.sec-ttl{
  font-size:.59rem;color:var(--t3);letter-spacing:.13em;
  text-transform:uppercase;margin-bottom:8px;
  padding-bottom:5px;border-bottom:1px solid var(--bd);
}
.fr{display:flex;align-items:center;gap:7px;margin-bottom:6px}
.fr label{font-size:.69rem;color:var(--t1);min-width:96px;flex-shrink:0}
.fr .fi,.fr .fs{flex:1;min-width:0}

.stats-grid{display:grid;grid-template-columns:1fr 1fr;gap:6px 13px}
.stat-slide{display:flex;align-items:center;gap:7px}
.stat-slide label{font-size:.65rem;color:var(--t1);width:64px;flex-shrink:0}
.stat-slide input[type=range]{flex:1;-webkit-appearance:none;appearance:none;height:4px;background:var(--bd);cursor:pointer}
.stat-slide input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:11px;height:11px;background:var(--ac);border-radius:50%}
.sv-lbl{font-family:var(--fd);font-size:.79rem;color:var(--ac);min-width:20px;text-align:right}

.ctr-list{display:flex;flex-direction:column;gap:4px}
.ctr-item{display:flex;align-items:center;gap:7px;background:var(--s2);padding:4px 8px;border:1px solid var(--bd)}
.ctr-item span{flex:1;font-size:.72rem;color:var(--t1)}
.ctr-amt{font-family:var(--fd);color:var(--ac);white-space:nowrap}
.ctr-del{background:none;border:none;color:var(--rd);font-size:.73rem;padding:0 3px}
.ctr-add{display:flex;gap:5px;margin-top:6px}
.ctr-add .fi{padding:3px 7px}

.sa-area{
  background:var(--s2);border:1px solid var(--bd);
  color:var(--t0);font-family:var(--fm);font-size:.74rem;
  padding:7px;width:100%;resize:vertical;min-height:70px;line-height:1.55;
}
.sa-area:focus{outline:none;border-color:var(--acd)}
.sa-cnt{font-size:.59rem;color:var(--t3);text-align:right;margin-top:3px}

.btn-save-prof{
  background:var(--acd);border:1px solid var(--ac);color:var(--ac);
  font-family:var(--fd);font-size:.76rem;padding:8px 16px;
  letter-spacing:.1em;transition:all var(--tr);width:100%;margin-top:4px;
}
.btn-save-prof:hover{background:var(--acg);box-shadow:0 0 10px var(--acg)}

.btn-expel{
  background:var(--rdd);border:1px solid var(--rd);color:var(--rd);
  font-family:var(--fd);font-size:.72rem;padding:5px 12px;
  letter-spacing:.07em;transition:all var(--tr);width:100%;margin-top:5px;
}
.btn-expel:hover{background:rgba(255,51,85,.2)}

.btn-del-student{
  background:var(--s2);border:1px solid var(--rd);color:var(--rd);
  font-family:var(--fd);font-size:.68rem;padding:5px 12px;
  letter-spacing:.06em;transition:all var(--tr);width:100%;margin-top:8px;opacity:.65;
}
.btn-del-student:hover{background:rgba(255,51,85,.12);opacity:1}

.mt8{margin-top:8px}
.mt12{margin-top:12px}

/* ═══════════════════════════════════════════════════════════════
   MODAL (standard)
═══════════════════════════════════════════════════════════════ */
#modal-overlay{
  position:fixed;inset:0;z-index:600; /* v7.5: above save modal z:500 */
  background:var(--overlay);display:flex;align-items:center;justify-content:center;
}
#modal-overlay.hidden{display:none}
#modal-box{
  background:var(--modal-bg);border:1px solid var(--modal-bd);
  max-width:490px;width:93%;max-height:82vh;overflow-y:auto;
  padding:20px;position:relative;box-shadow:0 0 40px rgba(0,0,0,.9);
}
#modal-x{position:absolute;top:9px;right:11px;background:none;border:none;color:var(--t1);font-size:.93rem}
#modal-x:hover{color:var(--rd)}
.m-title{
  font-family:var(--fd);font-size:.79rem;color:var(--t1);
  letter-spacing:.1em;margin-bottom:12px;padding-bottom:7px;border-bottom:1px solid var(--bd);
}
.m-body p{font-size:.81rem;color:var(--t0);line-height:1.72;margin-bottom:13px}
.m-body strong{color:var(--rd)}
.btn-row{display:flex;gap:7px;justify-content:center}
.import-info{
  background:var(--s2);border:1px solid var(--bd);
  padding:10px 12px;font-size:.73rem;color:var(--t1);line-height:1.65;margin-bottom:12px;
}
.import-info code{color:var(--ac)}

/* ═══════════════════════════════════════════════════════════════
   TOAST
═══════════════════════════════════════════════════════════════ */
#toast{
  position:fixed;bottom:14px;right:14px;z-index:600;
  background:var(--s2);border:1px solid var(--acd);color:var(--ac);
  padding:6px 13px;font-size:.75rem;letter-spacing:.04em;
  max-width:340px;opacity:0;pointer-events:none;transition:opacity .28s;
}
#toast.on{opacity:1}
#toast.on.ok{border-color:#00a855;color:var(--gn)}
#toast.on.err{border-color:var(--rdd);color:var(--rd)}
#toast.on.io{border-color:var(--iod);color:var(--io)}
#toast.on.warn{border-color:var(--ywd);color:var(--yw)}

/* ═══════════════════════════════════════════════════════════════
   PROFILE sidebar protect points
═══════════════════════════════════════════════════════════════ */
.prof-prot{
  font-family:var(--fm);font-size:.75rem;color:var(--t2);
  margin-top:4px;letter-spacing:.03em;
}
.prof-prot.active{color:var(--yw)}
.prof-prot-unit{opacity:.8}

/* ═══════════════════════════════════════════════════════════════
   LOADING SCREEN
═══════════════════════════════════════════════════════════════ */
#loading{
  position:fixed;inset:0;background:var(--s0);z-index:999;
  display:flex;flex-direction:column;align-items:center;justify-content:center;gap:10px;
}
.ld-logo{font-family:var(--fd);font-size:2.1rem;font-weight:900;color:var(--ac);letter-spacing:.22em}
.ld-txt{font-size:.75rem;color:var(--t3);letter-spacing:.1em;animation:blink 1s infinite}
.ld-sub{font-size:.63rem;color:var(--t3);opacity:.55}
@keyframes blink{0%,100%{opacity:1}50%{opacity:.2}}

/* ═══════════════════════════════════════════════════════════════
   NO-DATA STATE (v6.5+)
═══════════════════════════════════════════════════════════════ */
.no-data-wrap{
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  gap:14px;padding:60px 20px;text-align:center;
}
.no-data-title{
  font-family:var(--fd);font-size:1.1rem;color:var(--t2);
  letter-spacing:.15em;
}
.no-data-sub{
  font-size:.75rem;color:var(--t3);line-height:1.7;max-width:360px;
}
.btn-init{
  background:var(--acd);border:1px solid var(--ac);color:var(--ac);
  font-family:var(--fd);font-size:.78rem;padding:9px 22px;
  letter-spacing:.1em;transition:all var(--tr);
}
.btn-init:hover{background:var(--acg);box-shadow:0 0 12px var(--acg)}

/* ═══════════════════════════════════════════════════════════════
   CUSTOM UI CONFIRM / ALERT — v7.5
   z-index:1000 — topmost layer, above save modal (z:500),
   standard modal (z:600), and everything else.
   Variants: .uic-danger (delete), .uic-warn (overwrite/unsaved),
             .uic-info (save confirm — default)
═══════════════════════════════════════════════════════════════ */
#uic-overlay{
  position:fixed;inset:0;z-index:1000;
  background:rgba(0,0,0,.88);
  display:flex;align-items:center;justify-content:center;
  padding:20px;
}
#uic-overlay.hidden{display:none}

#uic-box{
  background:var(--modal-bg);
  border:1px solid var(--modal-bd);
  border-radius:8px;
  width:clamp(300px,42vw,480px);
  max-width:94vw;
  padding:0;
  box-shadow:0 0 50px rgba(0,0,0,.95);
  overflow:hidden;
  display:flex;flex-direction:column;
}

#uic-header{
  padding:12px 16px 10px;
  border-bottom:1px solid var(--bd2);
  display:flex;align-items:center;gap:8px;
}
.uic-title{
  font-family:var(--fd);font-size:.76rem;
  color:var(--ac);letter-spacing:.14em;
  flex:1;
}
/* Danger variant — delete confirmation */
#uic-box.uic-danger #uic-header{ border-bottom-color:var(--rdd); }
#uic-box.uic-danger .uic-title { color:var(--rd); }
/* Warning variant — overwrite / unsaved */
#uic-box.uic-warn   #uic-header{ border-bottom-color:var(--ywd); }
#uic-box.uic-warn   .uic-title { color:var(--yw); }

.uic-body{
  padding:16px 16px 12px;
  font-size:.80rem;color:var(--t0);
  line-height:1.7;
}
.uic-body strong{ color:var(--rd); }
#uic-box.uic-warn .uic-body strong{ color:var(--yw); }

.uic-actions{
  display:flex;gap:8px;
  padding:10px 16px 14px;
  justify-content:flex-end;
}
.uic-btn{
  font-family:var(--fm);font-size:.72rem;letter-spacing:.06em;
  padding:7px 18px;border:1px solid var(--bd);
  background:var(--s3);color:var(--t0);
  cursor:pointer;transition:all var(--tr);
}
.uic-btn:hover{border-color:var(--ac);color:var(--ac);background:var(--s4)}
.uic-btn:active{transform:scale(.97)}

/* OK button variants */
.uic-btn-ok{
  border-color:var(--acd);color:var(--ac);
}
.uic-btn-ok:hover{background:var(--acg)}
#uic-box.uic-danger .uic-btn-ok{border-color:var(--rdd);color:var(--rd)}
#uic-box.uic-danger .uic-btn-ok:hover{background:rgba(255,51,85,.12);border-color:var(--rd)}
#uic-box.uic-warn   .uic-btn-ok{border-color:var(--ywd);color:var(--yw)}
#uic-box.uic-warn   .uic-btn-ok:hover{background:rgba(255,215,0,.1);border-color:var(--yw)}

/* Cancel button — always neutral */
.uic-btn-cancel{color:var(--t1)}

/* ═══════════════════════════════════════════════════════════════
   RANKING — v7.2 mini stat-bar helpers retained for any
   other uses; column removed from rnk-tbl in v7.3
═══════════════════════════════════════════════════════════════ */
.mc-0{color:var(--ac)}
.mc-1{color:#a78bfa}
.mc-2{color:#60c0ff}
.mc-3{color:#00ffcc}
.mc-4{color:#ff9f44}
.mc-5{color:#ff6680}
.mc-6{color:var(--gn)}
.mc-7{color:var(--yw)}
.mc-8{color:var(--or)}

/* ═══════════════════════════════════════════════════════════════
   COHORT BLOCKS — v7.4
   Used by both Graduates (by graduateYear) and Incoming (by cohortGrade).
═══════════════════════════════════════════════════════════════ */
.cohort-block{
  margin-bottom:14px;
  border:1px solid var(--bd);
  border-radius:6px;
  overflow:hidden;
}
.cohort-hdr{
  display:flex;align-items:center;gap:10px;
  padding:9px 14px;
  background:var(--s2);
  cursor:pointer;
  user-select:none;
  border-bottom:1px solid var(--bd);
  transition:background var(--tr);
}
.cohort-hdr:hover{background:var(--s3)}
.cohort-yr{
  font-family:var(--fd);font-size:.72rem;
  color:var(--yw);letter-spacing:.1em;flex:1;
}
.cohort-cnt{
  font-size:.68rem;color:var(--t2);letter-spacing:.05em;
}
.cohort-del-btn{
  font-size:.65rem;color:var(--rd);
  border:1px solid var(--rdd);
  padding:2px 7px;border-radius:3px;
  background:none;cursor:pointer;
  transition:all var(--tr);
}
.cohort-del-btn:hover{background:rgba(255,51,85,.12);border-color:var(--rd)}

/* v7.5: ランダム生成 button inside cohort-hdr — yellow accent, no emoji */
.cohort-rnd-btn{
  font-size:.65rem;color:var(--yw);
  border:1px solid var(--ywd);
  padding:2px 8px;border-radius:3px;
  background:none;cursor:pointer;
  font-family:var(--fm);letter-spacing:.04em;
  transition:all var(--tr);
}
.cohort-rnd-btn:hover{background:rgba(255,215,0,.10);border-color:var(--yw)}
.cohort-arrow{
  font-size:.7rem;color:var(--t2);width:10px;text-align:center;
  transition:transform .15s ease;
}
.cohort-body{
  padding:10px 12px;
  transition:max-height .25s ease, opacity .2s ease, padding .2s ease;
  max-height:9999px;
  opacity:1;
}
.cohort-body.cohort-collapsed{
  max-height:0;
  overflow:hidden;
  opacity:0;
  padding:0 12px;
}
/* Incoming cohort: class sub-blocks */
.inc-cls-block{
  margin-bottom:12px;
}
.inc-cls-hdr{
  display:flex;align-items:center;gap:8px;
  padding:4px 8px;
  background:var(--s3);
  border-bottom:1px solid var(--bd);
  margin-bottom:6px;
}
/* Empty state note for Incoming / Graduates pages */
.sp-empty-note{
  padding:28px 20px;
  text-align:center;
  color:var(--t2);
  font-size:.78rem;
  line-height:1.8;
  border:1px dashed var(--bd);
  border-radius:6px;
  margin-top:10px;
}

.hidden{display:none!important}
